{% extends "base.html" %}
{% block title %}Earnings - {{ partner.business_name }}{% endblock %}

{% block content %}
<h1>{{ partner.business_name }} - Earnings</h1>

<h2>Summary</h2>
<div class="earnings-cards" style="display:grid;grid-template-columns:repeat(3,1fr);gap:var(--spacing-md);margin:var(--spacing-md) 0;">
    <div style="padding:var(--spacing-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);">
        <div style="font-size:0.9em;color:var(--color-text-secondary);">Gross</div>
        <div style="font-size:1.5em;font-weight:600;">${{ summary.gross | default(0) }}</div>
    </div>
    <div style="padding:var(--spacing-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);">
        <div style="font-size:0.9em;color:var(--color-text-secondary);">Commission</div>
        <div style="font-size:1.5em;font-weight:600;">${{ summary.commission | default(0) }}</div>
    </div>
    <div style="padding:var(--spacing-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);">
        <div style="font-size:0.9em;color:var(--color-text-secondary);">Net</div>
        <div style="font-size:1.5em;font-weight:600;">${{ summary.net | default(0) }}</div>
    </div>
</div>

<h2>Payout History</h2>
<table style="width:100%;border-collapse:collapse;margin-top:var(--spacing-md);">
    <thead>
        <tr>
            <th style="padding:var(--spacing-sm);text-align:left;border-bottom:1px solid var(--color-border);">Date</th>
            <th style="padding:var(--spacing-sm);text-align:left;border-bottom:1px solid var(--color-border);">Amount</th>
            <th style="padding:var(--spacing-sm);text-align:left;border-bottom:1px solid var(--color-border);">Status</th>
        </tr>
    </thead>
    <tbody>
        {% for p in payouts %}
        <tr>
            <td style="padding:var(--spacing-sm);border-bottom:1px solid var(--color-border);">{{ p.created_at[:10] if p.created_at else '-' }}</td>
            <td style="padding:var(--spacing-sm);border-bottom:1px solid var(--color-border);">${{ (p.amount_cents or 0) / 100 }}</td>
            <td style="padding:var(--spacing-sm);border-bottom:1px solid var(--color-border);">{{ p.status }}</td>
        </tr>
        {% else %}
        <tr><td colspan="3" style="padding:var(--spacing-md);color:var(--color-text-secondary);">No payouts yet.</td></tr>
        {% endfor %}
    </tbody>
</table>

<h2>Recent Commission Breakdown</h2>
<table style="width:100%;border-collapse:collapse;margin-top:var(--spacing-md);">
    <thead>
        <tr>
            <th style="padding:var(--spacing-sm);text-align:left;border-bottom:1px solid var(--color-border);">Order</th>
            <th style="padding:var(--spacing-sm);text-align:left;border-bottom:1px solid var(--color-border);">Gross</th>
            <th style="padding:var(--spacing-sm);text-align:left;border-bottom:1px solid var(--color-border);">Commission</th>
            <th style="padding:var(--spacing-sm);text-align:left;border-bottom:1px solid var(--color-border);">Net</th>
        </tr>
    </thead>
    <tbody>
        {% for c in commissions %}
        <tr>
            <td style="padding:var(--spacing-sm);border-bottom:1px solid var(--color-border);">{{ (c.order_id or '')[:8] }}...</td>
            <td style="padding:var(--spacing-sm);border-bottom:1px solid var(--color-border);">${{ (c.gross_cents or 0) / 100 }}</td>
            <td style="padding:var(--spacing-sm);border-bottom:1px solid var(--color-border);">${{ (c.commission_cents or 0) / 100 }}</td>
            <td style="padding:var(--spacing-sm);border-bottom:1px solid var(--color-border);">${{ (c.net_cents or 0) / 100 }}</td>
        </tr>
        {% else %}
        <tr><td colspan="4" style="padding:var(--spacing-md);color:var(--color-text-secondary);">No commission data yet.</td></tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
